# SonarCloud Configuration for CMake Prototype
# This shows how to configure SonarCloud for C++ coverage with gcovr

sonar.projectKey=griswaldbrooks_halloween
sonar.organization=griswaldbrooks

# Project metadata
sonar.projectName=CMake Arduino Library Prototype
sonar.projectVersion=1.0.0

# === Source Code ===
# Only analyze the library code (not tests, not Arduino sketches)
sonar.sources=lib

# === Tests ===
sonar.tests=test
sonar.test.inclusions=test/**/*.cpp

# === Coverage ===
# Point to the gcovr-generated SonarQube XML file
sonar.coverageReportPaths=coverage.xml

# === C++ Configuration ===
# File suffixes to analyze
sonar.cpp.file.suffixes=.h,.cpp

# Disable C analysis (we're pure C++)
sonar.c.file.suffixes=-

# Compilation database (REQUIRED for C++ analysis)
# CMake generates this automatically with CMAKE_EXPORT_COMPILE_COMMANDS
# Path is relative to repository root, not projectBaseDir
sonar.cfamily.compile-commands=cmake_prototype/build/compile_commands.json

# === Exclusions ===
# Don't analyze build artifacts
sonar.exclusions=build/**,coverage/**,arduino_sketch/**

# Don't expect coverage for Arduino sketch (it's hardware-dependent)
sonar.coverage.exclusions=arduino_sketch/**

# === Quality Settings ===
# Source encoding
sonar.sourceEncoding=UTF-8

# === Notes for Integration ===
# 1. Generate coverage with: pixi run coverage
# 2. This creates coverage.xml in SonarQube format
# 3. SonarCloud will read coverage.xml automatically
# 4. The path in coverage.xml matches the path SonarCloud sees
# 5. Only lib/ code is analyzed and covered (tests and Arduino excluded)

# === Path Handling ===
# gcovr generates coverage.xml with paths relative to project root
# SonarCloud expects the same, so no path prefix needed
# Example coverage.xml path: <class filename="lib/servo_logic.cpp" ...>
# SonarCloud file key: cmake_prototype:lib/servo_logic.cpp
# These match, so coverage will display correctly
